"use strict";(self.webpackChunkdatalogic_github_io=self.webpackChunkdatalogic_github_io||[]).push([[5234],{3905:function(e,n,t){t.d(n,{Zo:function(){return p},kt:function(){return m}});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function l(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)t=o[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),c=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},p=function(e){var n=c(e.components);return a.createElement(s.Provider,{value:n},e.children)},u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},d=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),d=c(t),m=r,g=d["".concat(s,".").concat(m)]||d[m]||u[m]||o;return t?a.createElement(g,i(i({ref:n},p),{},{components:t})):a.createElement(g,i({ref:n},p))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var o=t.length,i=new Array(o);i[0]=d;var l={};for(var s in n)hasOwnProperty.call(n,s)&&(l[s]=n[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var c=2;c<o;c++)i[c]=t[c];return a.createElement.apply(null,i)}return a.createElement.apply(null,t)}d.displayName="MDXCreateElement"},58215:function(e,n,t){t.d(n,{Z:function(){return r}});var a=t(67294);function r(e){var n=e.children,t=e.hidden,r=e.className;return a.createElement("div",{role:"tabpanel",hidden:t,className:r},n)}},9877:function(e,n,t){t.d(n,{Z:function(){return p}});var a=t(87462),r=t(67294),o=t(72389),i=t(63725),l=t(86010),s="tabItem_LplD";function c(e){var n,t,o,c=e.lazy,p=e.block,u=e.defaultValue,d=e.values,m=e.groupId,g=e.className,h=r.Children.map(e.children,(function(e){if((0,r.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),v=null!=d?d:h.map((function(e){var n=e.props;return{value:n.value,label:n.label,attributes:n.attributes}})),f=(0,i.lx)(v,(function(e,n){return e.value===n.value}));if(f.length>0)throw new Error('Docusaurus error: Duplicate values "'+f.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var k=null===u?u:null!=(n=null!=u?u:null==(t=h.find((function(e){return e.props.default})))?void 0:t.props.value)?n:null==(o=h[0])?void 0:o.props.value;if(null!==k&&!v.some((function(e){return e.value===k})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+k+'" but none of its children has the corresponding value. Available values are: '+v.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var b=(0,i.UB)(),N=b.tabGroupChoices,y=b.setTabGroupChoices,O=(0,r.useState)(k),C=O[0],S=O[1],E=[],w=(0,i.o5)().blockElementScrollPositionUntilNextRender;if(null!=m){var x=N[m];null!=x&&x!==C&&v.some((function(e){return e.value===x}))&&S(x)}var D=function(e){var n=e.currentTarget,t=E.indexOf(n),a=v[t].value;a!==C&&(w(n),S(a),null!=m&&y(m,a))},T=function(e){var n,t=null;switch(e.key){case"ArrowRight":var a=E.indexOf(e.currentTarget)+1;t=E[a]||E[0];break;case"ArrowLeft":var r=E.indexOf(e.currentTarget)-1;t=E[r]||E[E.length-1]}null==(n=t)||n.focus()};return r.createElement("div",{className:"tabs-container"},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.Z)("tabs",{"tabs--block":p},g)},v.map((function(e){var n=e.value,t=e.label,o=e.attributes;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:C===n?0:-1,"aria-selected":C===n,key:n,ref:function(e){return E.push(e)},onKeyDown:T,onFocus:D,onClick:D},o,{className:(0,l.Z)("tabs__item",s,null==o?void 0:o.className,{"tabs__item--active":C===n})}),null!=t?t:n)}))),c?(0,r.cloneElement)(h.filter((function(e){return e.props.value===C}))[0],{className:"margin-vert--md"}):r.createElement("div",{className:"margin-vert--md"},h.map((function(e,n){return(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==C})}))))}function p(e){var n=(0,o.Z)();return r.createElement(c,(0,a.Z)({key:String(n)},e))}},18672:function(e,n,t){t.r(n),t.d(n,{Img:function(){return d},assets:function(){return p},contentTitle:function(){return s},default:function(){return g},frontMatter:function(){return l},metadata:function(){return c},toc:function(){return u}});var a=t(87462),r=t(63366),o=(t(67294),t(3905)),i=(t(9877),t(58215),["components"]),l={id:"tutorialcsharpscanner",title:"C# Barcode Reader Tutorial",sidebar_label:"C# Barcode Reader Tutorial"},s=void 0,c={unversionedId:"opos/develop/tutorialcsharpscanner",id:"opos/develop/tutorialcsharpscanner",title:"C# Barcode Reader Tutorial",description:"<img src=",source:"@site/docs/opos/develop/tutorialcsharpscanner.md",sourceDirName:"opos/develop",slug:"/opos/develop/tutorialcsharpscanner",permalink:"/opos/develop/tutorialcsharpscanner",tags:[],version:"current",frontMatter:{id:"tutorialcsharpscanner",title:"C# Barcode Reader Tutorial",sidebar_label:"C# Barcode Reader Tutorial"},sidebar:"OPOS",previous:{title:"C++ Live Weight Reader Tutorial",permalink:"/opos/develop/tutorialcppscale"},next:{title:"C# Live Weight Reader Tutorial",permalink:"/opos/develop/tutorialcsharpscale"}},p={},u=[{value:"Introduction",id:"introduction",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Creating a project",id:"creating-a-project",level:2},{value:"Exposing OPOS control objects",id:"exposing-opos-control-objects",level:2},{value:"Creating the OPOS scanner object",id:"creating-the-opos-scanner-object",level:2},{value:"Accessing the OPOS Scanner interface",id:"accessing-the-opos-scanner-interface",level:2},{value:"Implementing event functions",id:"implementing-event-functions",level:4},{value:"Tying it all together",id:"tying-it-all-together",level:2}],d=function(e){var n=e.src;return(0,o.kt)("img",{src:n,style:{maxWidth:"750px",maxHeight:"750px"}})},m={toc:u,Img:d};function g(e){var n=e.components,t=(0,r.Z)(e,i);return(0,o.kt)("wrapper",(0,a.Z)({},m,t,{components:n,mdxType:"MDXLayout"}),(0,o.kt)("h2",{id:"introduction"},"Introduction"),(0,o.kt)("p",null,"In this tutorial, we will be creating a simple console application in C# that opens, claims and enables a scanner device and provides a mechanism to see what labels were scanned with that device. This tutorial only covers a very basic aspect of development using OPOS with C#, but should suffice as a starting point for any application that looks to read labels from a Datalogic scanning device."),(0,o.kt)("h2",{id:"prerequisites"},"Prerequisites"),(0,o.kt)("p",null,"Developing an application for a Datalogic scanning device requires you to first have Datalogic's OPOS installed. The OPOS installer ensures the required ActiveX Controls are registered and any supporting files are present."),(0,o.kt)("h2",{id:"creating-a-project"},"Creating a project"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Using Visual Studio 2019, navigate to ",(0,o.kt)("strong",{parentName:"p"},"File > New > Project ...")),(0,o.kt)(d,{src:"/img/opos/develop/csharp/filenewproject.png",mdxType:"Img"})),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"In the ",(0,o.kt)("strong",{parentName:"p"},"Create a new project")," dialog, set the filter to ",(0,o.kt)("strong",{parentName:"p"},"C#"),", select ",(0,o.kt)("strong",{parentName:"p"},"Console App")," and select ",(0,o.kt)("strong",{parentName:"p"},"Next")),(0,o.kt)(d,{src:"/img/opos/develop/csharp/createnewproject.png",mdxType:"Img"})),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"In the ",(0,o.kt)("strong",{parentName:"p"},"Configure your new project")," dialog, declare your ",(0,o.kt)("strong",{parentName:"p"},"Project name"),", ",(0,o.kt)("strong",{parentName:"p"},"Location")," and ",(0,o.kt)("strong",{parentName:"p"},"Solution name")," as desired and then select ",(0,o.kt)("strong",{parentName:"p"},"Next"),"."),(0,o.kt)(d,{src:"/img/opos/develop/csharp/scanner/configurenewproject.png",mdxType:"Img"})),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"In the ",(0,o.kt)("strong",{parentName:"p"},"Additional information")," dialog, make sure the Target Framework is set to ",(0,o.kt)("em",{parentName:"p"},".NET 5.0")," and then select ",(0,o.kt)("strong",{parentName:"p"},"Create"),"."),(0,o.kt)(d,{src:"/img/opos/develop/csharp/additionalinfo.png",mdxType:"Img"})),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"After the project has initialized, you ",(0,o.kt)("strong",{parentName:"p"},"must create and use an x86 configuration"),"; failure to do this will result in the unhandled exception ",(0,o.kt)("em",{parentName:"p"},"80040154 Class not registered (0x80040154 (REGDB_E_CLASSNOTREG))")," when you run the application. The Configuration Manager can be accessed by navigating to ",(0,o.kt)("strong",{parentName:"p"},"Build > Configuration Manager..."),"."),(0,o.kt)(d,{src:"/img/opos/develop/csharp/scanner/newsolutionplatform.png",mdxType:"Img"}))),(0,o.kt)("h2",{id:"exposing-opos-control-objects"},"Exposing OPOS control objects"),(0,o.kt)("p",null,"The very first step is to reference the scanner ActiveX Control as a ",(0,o.kt)("inlineCode",{parentName:"p"},"dependency"),"."),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Using the Visual Studio 2019 ",(0,o.kt)("strong",{parentName:"p"},"Solution Explorer"),", right mouse click ",(0,o.kt)("strong",{parentName:"p"},"Dependencies")," and select ",(0,o.kt)("strong",{parentName:"p"},"Add COM Reference")," from the context menu."),(0,o.kt)(d,{src:"/img/opos/develop/csharp/scanner/addcomreference.png",mdxType:"Img"})),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"When the ",(0,o.kt)("strong",{parentName:"p"},"Reference Manager")," dialog appears, filter on the keyword ",(0,o.kt)("strong",{parentName:"p"},"OPOS"),", select the ",(0,o.kt)("em",{parentName:"p"},"OPOS Scanner Control")," and then select OK."),(0,o.kt)(d,{src:"/img/opos/develop/csharp/scanner/addcomref.png",mdxType:"Img"})),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"At this point, expanding the ",(0,o.kt)("strong",{parentName:"p"},"Dependencies")," node of the ",(0,o.kt)("strong",{parentName:"p"},"Solution Explorer"),", you will see  ",(0,o.kt)("inlineCode",{parentName:"p"},"Interop.OposScanner_CCO"),"."),(0,o.kt)(d,{src:"/img/opos/develop/csharp/scanner/dependencies.png",mdxType:"Img"})),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Near the top of your source file, add the statement ",(0,o.kt)("inlineCode",{parentName:"p"},"using OposScanner_CCO;")))),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c#"},"using System;\nusing OPOSCONSTANTSLib;\nusing OposScanner_CCO;\n\nnamespace CSharpScannerApp\n{\n    class Program\n    {\n        static void Main(string[] args)\n        {\n        }\n    }\n}\n")),(0,o.kt)("h2",{id:"creating-the-opos-scanner-object"},"Creating the OPOS scanner object"),(0,o.kt)("p",null,"Creating the scanner object requires you to simply declare and instantiate it. However, if you attempt to build the application at this point you will encounter ",(0,o.kt)("em",{parentName:"p"},"error CS1752: Interop type 'OPOSScannerClass' cannot be embedded. Use the applicable interface instead.")),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c#"},"using System;\nusing OposScanner_CCO;\n\nnamespace CSharpScannerApp\n{\n    class Program\n    {\n        private static OPOSScannerClass scanner;\n\n        static void Main(string[] args)\n        {\n            // Create a scanner object.\n            scanner = new OPOSScannerClass();\n        }\n    }\n}\n")),(0,o.kt)("p",null,"This issue is easily resolved by the following:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Expand the ",(0,o.kt)("strong",{parentName:"p"},"Dependencies")," and ",(0,o.kt)("strong",{parentName:"p"},"COM")," nodes in the ",(0,o.kt)("strong",{parentName:"p"},"Solution Explorer"),".")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Right mouse click on ",(0,o.kt)("inlineCode",{parentName:"p"},"Interop.OposScanner_CCO")," and select ",(0,o.kt)("strong",{parentName:"p"},"Properties")," from the context menu.")),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Set ",(0,o.kt)("inlineCode",{parentName:"p"},"Embed Interop Types")," to ",(0,o.kt)("strong",{parentName:"p"},"No"),"."),(0,o.kt)(d,{src:"/img/opos/develop/csharp/scanner/embededproperty.png",mdxType:"Img"}))),(0,o.kt)("h2",{id:"accessing-the-opos-scanner-interface"},"Accessing the OPOS Scanner interface"),(0,o.kt)("p",null,"At this point, you are ready to use the ",(0,o.kt)("inlineCode",{parentName:"p"},"scanner")," object. "),(0,o.kt)("p",null,"The OPOS standard defines a general sequence to access a device:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"open"),": open a context to the device"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"claim"),": claim control over the device"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"enable"),": enable the device's operation"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"disable"),": disable the device's  operation"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"release"),": release control over the device"),(0,o.kt)("li",{parentName:"ul"},(0,o.kt)("strong",{parentName:"li"},"close"),": close the context to the device")),(0,o.kt)("p",null,"Opening a scanner context requires you to reference a ",(0,o.kt)("em",{parentName:"p"},"device profile")," (a device profile simply being a name representing a set of parameters relevant to the device). When OPOS is installed, scanner profiles are seen as the subkey names installed under the UPOS-specified registry key ",(0,o.kt)("inlineCode",{parentName:"p"},"HKEY_LOCAL_MACHINE\\Software\\Wow6432Node\\OLEforRetail\\ServiceOPOS\\SCANNER"),". It is your choice whether you want to programmatically obtain the profile names from the registry or to simply hard-code them in your application."),(0,o.kt)("p",null,"If the scanner context is successfully opened, you can then claim the device, gaining exclusive access to it. And if the device is successfully claimed, you can then enable it to perform subsequent operations."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c#"},'using System;\nusing OposScanner_CCO;\n\nnamespace CSharpScannerApp\n{\n    class Program\n    {\n        private static OPOSScannerClass scanner;\n\n        static void Main(string[] args)\n        {\n            // Create a scanner object.\n            scanner = new OPOSScannerClass();\n\n            // Open a context with the scanner (e.g. "USBScanner").\n            string profileName = "<your selected profile>";\n            scanner.Open(profileName);\n\n            // Claim control of the scanner using a 1000 millisecond timeout.\n            scanner.ClaimDevice(1000);\n            if (scanner.Claimed)\n            {\n                // Enable the scanner and decoding events.\n                scanner.DeviceEnabled = true;\n                scanner.DataEventEnabled = true;\n                scanner.DecodeData = true;\n\n                //\n                // more to come .... \n                //\n\n                // Disable and release the scanner.\n                scanner.DataEventEnabled = false;\n                scanner.ReleaseDevice();\n            }\n\n            // Finally, close the scanner context.\n            scanner.Close();\n        }\n    }\n}\n')),(0,o.kt)("h4",{id:"implementing-event-functions"},"Implementing event functions"),(0,o.kt)("p",null,"At this point, the scanner object can act as a ",(0,o.kt)("em",{parentName:"p"},"sink")," (an object that receives input from the device). However, to make the application useful you must connect the scanner object to a ",(0,o.kt)("inlineCode",{parentName:"p"},"DataEvent()")," method, allowing the application to retrieve the label data obtained by the scanner object."),(0,o.kt)("p",null,"To see the event methods of the associated interface class ",(0,o.kt)("inlineCode",{parentName:"p"},"_IOPOSScannerEvents_Event")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Right mouse click on ",(0,o.kt)("inlineCode",{parentName:"p"},"OPOSScannerClass")," in your source code and then select ",(0,o.kt)("strong",{parentName:"p"},"Peek Definition")," from the context menu."),(0,o.kt)(d,{src:"/img/opos/develop/csharp/scanner/peekdefinition_a.png",mdxType:"Img"})),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Scrolling to the bottom of the displayed window you see four event methods."),(0,o.kt)(d,{src:"/img/opos/develop/csharp/scanner/peekdefinition_b.png",mdxType:"Img"})),(0,o.kt)("li",{parentName:"ol"},(0,o.kt)("p",{parentName:"li"},"Placing your cursor over ",(0,o.kt)("inlineCode",{parentName:"p"},"_IOPOSScannerEvents_DataEventEventHandler")," you will see the method signature."),(0,o.kt)(d,{src:"/img/opos/develop/csharp/scanner/peekdefinition_c.png",mdxType:"Img"}))),(0,o.kt)("p",null,"For our purposes, we need to provide a simple DataEvent() method."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c#"},'  static private void DataEvent(int value)\n  {\n      Console.WriteLine("Data: " + scanner.ScanDataLabel);\n      scanner.DataEventEnabled = true;\n  }\n')),(0,o.kt)("h2",{id:"tying-it-all-together"},"Tying it all together"),(0,o.kt)("p",null,"All that remains to be done is to connect the scanner object to the delegate method ",(0,o.kt)("inlineCode",{parentName:"p"},"DataEvent()")," and to write some simple thread management code."),(0,o.kt)("p",null," Connecting the scanner object to the delegate method is done by simply adding the statement ",(0,o.kt)("inlineCode",{parentName:"p"},"scanner.DataEvent += DataEvent;")," to your code."),(0,o.kt)("p",null,"Finally, a more complete example can be found in the ",(0,o.kt)("a",{parentName:"p",href:"./datalogicoposexamples"},"Datalogic OPOS Examples"),"."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-c#"},'using System;\nusing System.Threading;\nusing OposScanner_CCO;\n\nnamespace CSharpScannerApp\n{\n    class Program\n    {\n        private static OPOSScannerClass scanner;\n\n        static void Main(string[] args)\n        {\n            // Setup the console program to exit gracefully.\n            var exitEvent = new ManualResetEvent(false);\n            Console.CancelKeyPress += (sender, eventArgs) =>\n            {\n                eventArgs.Cancel = true;\n                exitEvent.Set();\n            };\n\n            // Create a scanner object.\n            scanner = new OPOSScannerClass();\n\n            // Open a context with the scanner (e.g. "USBScanner").\n            string profileName = "<your selected profile>";\n            scanner.Open(profileName);\n\n            // Claim control of the scanner using a 1000 millisecond timeout.\n            scanner.ClaimDevice(1000);\n            if (scanner.Claimed)\n            {\n                // Subscribe to the delegate.\n                scanner.DataEvent += DataEvent;\n\n                // Enable the scanner and decoding events.\n                scanner.DeviceEnabled = true;\n                scanner.DataEventEnabled = true;\n                scanner.DecodeData = true;\n\n                // Wait for exit event (meanwhile handling scanner events).\n                exitEvent.WaitOne();\n\n                // Unsubscribe from the delegate.\n                scanner.DataEvent -= DataEvent;\n\n                // Disable and release the scanner.\n                scanner.DataEventEnabled = false;\n                scanner.ReleaseDevice();\n            }\n\n            // Finally, close the scanner context.\n            scanner.Close();\n        }\n\n        static private void DataEvent(int value)\n        {\n            Console.WriteLine("Data: " + scanner.ScanDataLabel);\n            scanner.DataEventEnabled = true;\n        }\n    }\n}\n')))}g.isMDXComponent=!0}}]);